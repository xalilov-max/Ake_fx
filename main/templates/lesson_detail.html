{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
  <h2>{{ lesson.title }}</h2>
  
  <!-- YouTube videoni iframe orqali ko'rsatish -->
  {% if lesson.video_url %}
  <div class="ratio ratio-16x9 mb-3 rounded-3 overflow-hidden">
      <iframe 
          src="{{ video_url }}"
          title="{{ lesson.title }}"
          class="embed-responsive-item"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
          loading="lazy">
      </iframe>
  </div>
  {% else %}
    <p>ðŸš« Video mavjud emas.</p>
  {% endif %}
  
  <div class="mt-3">
    {{ lesson.description|linebreaks }}
  </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const iframes = document.querySelectorAll('iframe[src*="youtube.com"]');
    
    iframes.forEach(iframe => {
        iframe.addEventListener('error', function() {
            const container = this.closest('.ratio');
            container.innerHTML = `
                <div class="d-flex align-items-center justify-content-center h-100 bg-light rounded">
                    <div class="text-center">
                        <i class="bi bi-exclamation-triangle text-warning display-4"></i>
                        <p class="mt-2 mb-0">Video yuklanishda xatolik yuz berdi</p>
                    </div>
                </div>
            `;
        });
    });
});
</script>
{% endblock %}
